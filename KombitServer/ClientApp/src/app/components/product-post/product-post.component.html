<ng-container *ngIf="isSkeleton">
  <nz-skeleton [nzActive]="true" [nzAvatar]="{size:'large', shape:'square'}"></nz-skeleton>
  <nz-skeleton [nzActive]="true" [nzAvatar]="{size:'large', shape:'square'}"></nz-skeleton>
  <nz-skeleton [nzActive]="true" [nzAvatar]="{size:'large', shape:'square'}"></nz-skeleton>
  <nz-skeleton [nzParagraph]="{rows: 10}" [nzActive]="true" [nzAvatar]="{size:'large', shape:'square'}"></nz-skeleton>
</ng-container>
<nz-spin [nzSpinning]="isLoading" [nzSize]="'large'">
  <form nz-form *ngIf="!isSkeleton" [formGroup]="validateForm">
    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired nzFor="productName">Upload Photo</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <nz-upload
          nzListType="picture-card"
          [nzFileList]="fileListImage"
          [nzBeforeUpload]="beforeUploadImage"
          [nzPreview]="handlePreviewImage"
          [nzRemove]="handleDeleteImage">
          <i nz-icon type="plus"></i>
          <div class="ant-upload-text">Upload</div>
        </nz-upload>
        <nz-modal [nzVisible]="previewVisible" [nzContent]="modalContent" [nzFooter]="null" (nzOnCancel)="previewVisible=false">
          <ng-template #modalContent>
            <img [src]="previewImage" [ngStyle]="{ 'width': '100%' }" />
          </ng-template>
        </nz-modal>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired nzFor="productName">Product Name</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <input id="productName" type="text" nz-input formControlName="productName">
        <nz-form-explain *ngIf="validateForm.get('productName').dirty && validateForm.get('productName').errors">Product name is required!</nz-form-explain>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired nzFor="solution">Solution</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <nz-select nzShowSearch nzAllowClear formControlName="solution">
          <ng-container *ngFor="let solution of listSolution">
            <nz-option *ngIf="!isLoading" [nzValue]="solution.id" [nzLabel]="solution.category"></nz-option>
          </ng-container>
        </nz-select>
        <nz-form-explain *ngIf="validateForm.get('solution').dirty && validateForm.get('solution').errors">Solution is required!</nz-form-explain>
      </nz-form-control>
    </nz-form-item>

    <div nz-col class="segment-button">
      <button nz-button [nzType]="segmentName === 'description' ? 'primary' : 'default'" (click)="changeSegment('description')">Description</button>
      <button nz-button [nzType]="segmentName === 'feature' ? 'primary' : 'default'" (click)="changeSegment('feature')">Feature</button>
      <button nz-button [nzType]="segmentName === 'benefit' ? 'primary' : 'default'" (click)="changeSegment('benefit')">Benefit</button>
      <button nz-button [nzType]="segmentName === 'implementation' ? 'primary' : 'default'" (click)="changeSegment('implementation')">Implementation</button>
      <button nz-button [nzType]="segmentName === 'faq' ? 'primary' : 'default'" (click)="changeSegment('faq')">Faq</button>
    </div>

    <div *ngIf="segmentName === 'description'">
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzRequired nzFor="Description">Description</nz-form-label>
        <nz-form-control class="quill-editor" [nzSpan]="12">
          <quill-editor (onEditorCreated)="quillCreated($event, 'Description')" placeholder="" formControlName="Description" [modules]="modules"></quill-editor>
          <nz-form-explain *ngIf="validateForm.get('Description').dirty && validateForm.get('Description').errors">Description is required!</nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="BusinessTarget">Business Target</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <textarea nz-input formControlName="BusinessTarget"></textarea>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="isSupplierAsContact">Supplier as Contact</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <nz-switch formControlName="isSupplierAsContact" [nzCheckedChildren]="checkedTemplate" [nzUnCheckedChildren]="unCheckedTemplate"></nz-switch>
          <ng-template #checkedTemplate><i nz-icon type="check"></i></ng-template>
          <ng-template #unCheckedTemplate><i nz-icon type="close"></i></ng-template>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item *ngIf="!validateForm.get('isSupplierAsContact').value">
        <nz-form-label [nzSpan]="7" nzRequired nzFor="selectedContact">Select User</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <nz-select nzShowSearch nzAllowClear formControlName="selectedContact">
            <ng-container *ngFor="let user of listUser">
              <nz-option *ngIf="!isLoading" [nzValue]="user.id" [nzLabel]="user.name"></nz-option>
            </ng-container>
          </nz-select>
          <nz-form-explain *ngIf="validateForm.get('selectedContact').dirty && validateForm.get('selectedContact').errors">Contact user is required!</nz-form-explain>
        </nz-form-control>
      </nz-form-item>
    </div>

    <div *ngIf="segmentName === 'feature'">
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="Feature">Feature</nz-form-label>
        <nz-form-control class="quill-editor" [nzSpan]="12">
          <quill-editor (onEditorCreated)="quillCreated($event, 'Feature')" placeholder="" formControlName="Feature" [modules]="modules"></quill-editor>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="price">Price</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <input NumbersOnly [allowCurrency]="true" [currencyText]="currency" id="price" type="text" nz-input formControlName="price">
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="price">Marketing Kit</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <nz-upload
            [nzFileList]="fileListMarketingKit"
            [nzBeforeUpload]="beforeUploadMarketingKit"
            [nzRemove]="handleDeleteMarketingKit">
            <button nz-button>
              <i nz-icon type="upload"></i><span>Upload</span>
            </button>
          </nz-upload>
        </nz-form-control>
      </nz-form-item>

    </div>

    <div *ngIf="segmentName === 'benefit'">
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="Benefit">Benefit</nz-form-label>
        <nz-form-control class="quill-editor" [nzSpan]="12">
          <quill-editor (onEditorCreated)="quillCreated($event, 'Benefit')" placeholder="" formControlName="Benefit" [modules]="modules"></quill-editor>
        </nz-form-control>
      </nz-form-item>
    </div>

    <div *ngIf="segmentName === 'implementation'">
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="Implementation">Implementation</nz-form-label>
        <nz-form-control class="quill-editor" [nzSpan]="12">
          <quill-editor (onEditorCreated)="quillCreated($event, 'Implementation')" placeholder="" formControlName="Implementation" [modules]="modules"></quill-editor>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="Credentials">Success story or client review</nz-form-label>
        <nz-form-control class="quill-editor" [nzSpan]="12">
          <quill-editor (onEditorCreated)="quillCreated($event, 'Credentials')" placeholder="" formControlName="Credentials" [modules]="modules"></quill-editor>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="7">Upload Video</nz-form-label>
        <nz-form-control [nzSpan]="12">
          <nz-upload
            [(nzFileList)]="fileListVideo"
            [nzBeforeUpload]="beforeUploadVideo">
            <button nz-button>
              <i nz-icon type="upload"></i><span>{{fileListVideo.length ? 'Change Video' : 'Select Video'}}</span>
            </button>
          </nz-upload>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzPush]="7" [nzSpan]="12">
          <div class="video-wrapper">
            <div class="placeholder">
              <video *ngIf="fileListVideo.length" controls="controls" controlList="nodownload" preload="metadata" webkit-playsinline="webkit-playsinline" class="videoPlayer" #videoShow>
                <source [src]="fileListVideo[0].url" type="video/mp4" /> Not Supported
              </video>
              <img *ngIf="!fileListVideo.length" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="alt="" />
            </div>
          </div>
        </nz-form-control>
      </nz-form-item>

    </div>

    <div *ngIf="segmentName === 'faq'">
      <nz-form-item>
        <nz-form-label [nzSpan]="7" nzFor="Faq">Faq</nz-form-label>
        <nz-form-control class="quill-editor" [nzSpan]="12">
          <quill-editor (onEditorCreated)="quillCreated($event, 'Faq')" placeholder="" formControlName="Faq" [modules]="modules"></quill-editor>
        </nz-form-control>
      </nz-form-item>
    </div>

    <div nz-col [nzSpan]="19">
      <button class="button-right" nz-button (click)="submitForm()">Publish</button>
    </div>
  </form>
</nz-spin>